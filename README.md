# PyAnalyzer - Анализатор Python-программ

PyAnalyzer - это мощный инструмент для анализа Python-программ, который оценивает их эффективность и использование ресурсов. Программа позволяет получить детальную информацию о зависимостях, профилировании кода и использовании системных ресурсов, представляя результаты в удобном для чтения HTML или JSON формате.

## Структура проекта

```
PY_Tester/
├── py_analyzer.py      # Основной файл программы
└── reports/            # Директория для хранения отчетов (создается автоматически)
```

## Описание файлов

### py_analyzer.py

Основной файл проекта, содержащий всю логику программы. Он включает в себя как консольный интерфейс, так и графический пользовательский интерфейс, построенный на PyQt6.

#### Основные классы и функции

##### Класс `PyAnalyzer`

Основной класс для анализа Python-программ.

```python
def __init__(self, target_file, output_format='html', monitor_duration=10, custom_logger=None)
```

**Аргументы:**
- `target_file` - путь к анализируемому Python-файлу
- `output_format` - формат выходного отчета ('html' или 'json')
- `monitor_duration` - продолжительность мониторинга ресурсов в секундах
- `custom_logger` - функция для логирования сообщений (опционально)

**Основные методы:**
- `run_analysis()` - запускает весь процесс анализа и возвращает путь к сгенерированному отчету
- `analyze_dependencies()` - анализирует зависимости программы
- `profile_code()` - профилирует выполнение кода
- `monitor_resources()` - отслеживает использование системных ресурсов
- `generate_report()` - генерирует отчет в выбранном формате

##### Класс `AnalyzerWorker(QThread)`

Рабочий поток для выполнения анализа в фоновом режиме в графическом интерфейсе.

**Сигналы:**
- `progress_update` - отправляет сообщения о прогрессе
- `analysis_complete` - сигнализирует о завершении анализа
- `error_occurred` - сигнализирует о возникновении ошибки

##### Класс `PyAnalyzerGUI(QMainWindow)`

Графический интерфейс для приложения.

**Основные методы:**
- `init_ui()` - инициализирует пользовательский интерфейс
- `browse_file()` - открывает диалог выбора файла
- `run_analysis()` - запускает анализ выбранного файла
- `cancel_analysis()` - отменяет текущий анализ
- `open_report()` - открывает отчет в браузере
- `save_settings()` / `load_settings()` - сохраняет/загружает настройки пользователя

##### Функция `main()`

Точка входа в программу. Обрабатывает аргументы командной строки и запускает соответствующий интерфейс (консольный или графический).

## Принцип работы

### Анализ зависимостей

Программа анализирует импорты в коде двумя способами:
1. Использование библиотеки `pipreqs` (если установлена)
2. Статический анализ кода с поиском import-выражений

Результат включает список всех импортированных модулей и пакетов с их версиями.

### Профилирование кода

Используется стандартный модуль `cProfile` для анализа:
- Времени выполнения функций
- Количества вызовов функций
- Накопленного времени выполнения

### Мониторинг ресурсов

С помощью библиотеки `psutil` отслеживается:
- Использование CPU
- Использование памяти (RSS и VMS)
- Дисковая активность (чтение/запись)
- Сетевая активность (отправлено/получено)

Результаты визуализируются в виде графиков с помощью `matplotlib`.

### Генерация отчетов

Программа может генерировать отчеты в двух форматах:
1. **HTML** - интерактивный отчет с графиками и таблицами
2. **JSON** - структурированные данные для дальнейшей обработки

Отчеты сохраняются в директории `reports/` и содержат временную метку в имени файла.

## Архитектура проекта

Программа использует модульную архитектуру:
1. **Ядро анализа** (`PyAnalyzer`) - отвечает за всю логику анализа
2. **Интерфейсы**:
   - Консольный интерфейс (аргументы командной строки)
   - Графический интерфейс (`PyAnalyzerGUI`)
3. **Асинхронная обработка** - использование потоков для выполнения анализа без блокировки GUI

## Используемые библиотеки

| Библиотека    | Назначение                                          |
|---------------|-----------------------------------------------------|
| PyQt6         | Графический пользовательский интерфейс             |
| psutil        | Мониторинг системных ресурсов                      |
| matplotlib    | Визуализация данных (графики)                      |
| pandas        | Обработка и анализ данных                          |
| jinja2        | Шаблонизация для генерации HTML-отчетов            |
| pipreqs       | Анализ зависимостей (опционально)                  |

## Запуск программы

### Консольный режим

```bash
python py_analyzer.py [путь_к_файлу] [--format {html,json}] [--duration SECONDS]
```

**Аргументы:**
- `путь_к_файлу` - путь к анализируемому Python-файлу
- `--format` - формат выходного отчета (html или json), по умолчанию html
- `--duration` - продолжительность мониторинга ресурсов в секундах, по умолчанию 10
- `--gui` - запустить графический интерфейс

### Графический режим

```bash
python py_analyzer.py --gui
```

или просто

```bash
python py_analyzer.py
```

## Особенности реализации

1. **Обработка кодировок** - программа корректно обрабатывает UTF-8 и другие кодировки, что важно для русскоязычных комментариев и строк в коде.

2. **Автоматическая установка зависимостей** - при первом запуске программа может предложить установить недостающие зависимости.

3. **Сохранение настроек** - программа сохраняет пользовательские настройки и историю отчетов между сеансами в директории `~/.py_analyzer/`.

4. **Оптимизация анализа зависимостей** - программа может работать как с pipreqs, так и с собственным алгоритмом анализа.

## Системные требования

- Python 3.6 или выше
- Доступ к командной строке для установки зависимостей
- Графический интерфейс для режима GUI

## Ограничения

- Анализируемая программа должна быть синтаксически корректной
- Для корректного профилирования программа должна выполняться без ошибок
- Некоторые динамические импорты могут не определяться при статическом анализе 
